# 预训练模型, 冷冻某些层. 
[参考](https://www.tensorflow.org/tutorials/images/transfer_learning)
```
from tensorflow import keras
import tensorflow as tf
# 伪数据
x_train = tf.random.uniform([100, 28, 28])
y_train = tf.random.uniform([100, 1], minval=0, maxval=10, dtype=tf.int32)
x_valid = tf.random.uniform([20, 28, 28])
y_valid = tf.random.uniform([20, 1], minval=0, maxval=10, dtype=tf.int32)

# 模型建立
model = keras.models.Sequential([
    keras.layers.Flatten(input_shape=[28, 28]),
    keras.layers.Dense(300, activation='relu'),
    keras.layers.Dense(100, activation='relu'),
    keras.layers.Dense(10, activation='softmax')
])
model.build()
model.summary()

# 查看模型有多少层
model.trainable = True 
print("Number of layers in the base model: ", len(model.layers))

# 冷冻一些层(根据Layer所在层次)
fine_tune_at = 2
for layer in model.layers[:fine_tune_at]:  # 冻结'fine_tune_at'层之前的所有层
  layer.trainable =  False

# 查看冷冻后的结果
for layer in model.layers:
    print("layer_name = {}, layer_trainable = {}".format(layer.name, layer.trainable))
    

# 模型训练
model.compile(loss="sparse_categorical_crossentropy", optimizer = "sgd", metrics = ["accuracy"])
history = model.fit(x_train, y_train, epochs=20, validation_data=(x_valid, y_valid))
```
